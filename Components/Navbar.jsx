"use client";

import React, { useState } from "react";
import Link from "next/link";
import { usePathname } from "next/navigation";
import { useTheme } from "@/hooks/useTheme";
import WalletSelectionPopup from "./shared/wallet-selection-popup";
import { useWallet } from "@solana/wallet-adapter-react";

function Navbar() {
  const pathname = usePathname();
  const { theme, setTheme, resolvedTheme } = useTheme();
  const { publicKey, disconnect } = useWallet();
  const [showWalletPopup, setShowWalletPopup] = useState(false);

  const navigationItems = [
    {
      name: "HOME",
      href: "/",
      icon: (isActive) => (
        <svg
          width="24"
          height="24"
          viewBox="0 0 34 34"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle
            cx="14.5316"
            cy="14.5316"
            r="14.5316"
            transform="matrix(-1 0 0 1 31.9805 2.29785)"
            stroke={isActive ? "white" : "#887FD4"}
            strokeWidth="4"
            strokeLinecap="round"
          />
          <path
            d="M25.1423 17.3886C25.1092 17.3597 25.0665 17.3438 25.0224 17.3438H10.0711C10.0269 17.3438 9.98427 17.3597 9.95112 17.3886L6.58119 20.3268C6.45552 20.4363 6.53373 20.6417 6.70112 20.6417H28.3923C28.5597 20.6417 28.6379 20.4363 28.5122 20.3268L25.1423 17.3886Z"
            fill={isActive ? "white" : "#887FD4"}
          />
          <path
            d="M25.1696 12.1488C25.1365 12.1199 25.0939 12.104 25.0497 12.104H10.0984C10.0543 12.104 10.0116 12.1199 9.97847 12.1488L6.60853 15.087C6.48286 15.1966 6.56107 15.402 6.72846 15.402H28.4196C28.587 15.402 28.6652 15.1966 28.5396 15.087L25.1696 12.1488Z"
            fill={isActive ? "white" : "#887FD4"}
          />
          <path
            d="M22.3945 9.38602C22.3945 9.28501 22.3154 9.20312 22.2179 9.20312H18.861C18.7634 9.20312 18.6843 9.28501 18.6843 9.38602V11.9059C18.6843 12.0069 18.7634 12.0888 18.861 12.0888H22.2179C22.3154 12.0888 22.3945 12.0069 22.3945 11.9059V9.38602Z"
            fill={isActive ? "white" : "#887FD4"}
          />
          <path
            d="M16.5195 9.50419C16.5195 9.40317 16.4382 9.32129 16.3379 9.32129H12.8879C12.7876 9.32129 12.7063 9.40317 12.7063 9.50419V12.0241C12.7063 12.1251 12.7876 12.207 12.8879 12.207H16.3379C16.4382 12.207 16.5195 12.1251 16.5195 12.0241V9.50419Z"
            fill={isActive ? "white" : "#887FD4"}
          />
          <path
            d="M22.3945 19.4661C22.3945 19.319 22.278 19.1997 22.1343 19.1997H12.967C12.8233 19.1997 12.7068 19.319 12.7068 19.4661V22.3344C12.7068 22.4815 12.8233 22.6007 12.967 22.6007H22.1343C22.278 22.6007 22.3945 22.4815 22.3945 22.3344V19.4661Z"
            fill={isActive ? "white" : "#887FD4"}
          />
        </svg>
      ),
    },
    {
      name: "STAKENOMICS",
      href: "/stakenomics",
      icon: (isActive) => (
        <svg
          width="24"
          height="24"
          viewBox="0 0 28 28"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <mask
            id="mask0_stakenomics"
            style={{ maskType: "alpha" }}
            maskUnits="userSpaceOnUse"
            x="0"
            y="0"
            width="28"
            height="28"
          >
            <circle
              cx="13.9937"
              cy="14.1064"
              r="13.3891"
              transform="rotate(90 13.9937 14.1064)"
              fill="#292B8C"
            />
          </mask>
          <g mask="url(#mask0_stakenomics)">
            <circle
              cx="13.8648"
              cy="14.1064"
              r="13.3891"
              transform="rotate(90 13.8648 14.1064)"
              fill={isActive ? "white" : "#887FD4"}
            />
            <g transform="translate(6, 5.5)">
              <path
                d="M2.41684 14.0123C1.45959 13.4612 0.684666 12.119 0.685988 11.0144L0.692534 5.54656L7.26468 9.33051L7.25574 16.7984L2.41684 14.0123Z"
                fill="#292B8C"
              />
              <path
                d="M15.3585 11.0649C15.3611 12.1695 14.5878 13.5127 13.6312 14.0649L8.89593 16.7989L8.87778 9.21526L15.3451 5.48133L15.3585 11.0649Z"
                fill="#292B8C"
              />
              <path
                d="M6.32233 1.34191C7.27693 0.78619 8.82678 0.78248 9.78403 1.33362L14.5226 4.06187L7.96864 7.87725L1.49683 4.15107L6.32233 1.34191Z"
                fill="#292B8C"
              />
            </g>
          </g>
        </svg>
      ),
    },
    {
      name: "PORTFOLIO",
      href: "/portfolio",
      icon: (isActive) => (
        <svg
          width="24"
          height="24"
          viewBox="0 0 28 28"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <mask
            id="mask0_portfolio"
            style={{ maskType: "alpha" }}
            maskUnits="userSpaceOnUse"
            x="0"
            y="0"
            width="28"
            height="28"
          >
            <circle
              cx="14.0445"
              cy="14.1059"
              r="13.3891"
              transform="rotate(90 14.0445 14.1059)"
              fill="#292B8C"
            />
          </mask>
          <g mask="url(#mask0_portfolio)">
            <circle
              cx="13.9156"
              cy="14.1059"
              r="13.3891"
              transform="rotate(90 13.9156 14.1059)"
              fill={isActive ? "white" : "#887FD4"}
            />
            <path
              d="M9.00781 8.96216L19.8672 8.96216C20.6956 8.96216 21.3672 9.63373 21.3672 10.4622L21.3672 18.6301C21.3672 19.4586 20.6956 20.1301 19.8672 20.1301L9.00781 20.1301C8.17938 20.1301 7.50781 19.4586 7.50781 18.6301L7.50781 10.4622C7.50781 9.63373 8.17939 8.96216 9.00781 8.96216Z"
              fill="#292B8C"
              stroke={isActive ? "white" : "#887FD4"}
            />
            <path
              d="M11.8984 7.32251L16.6953 7.32251C17.2475 7.32266 17.6953 7.77032 17.6953 8.32251L17.6953 11.5862C17.6953 12.1384 17.2475 12.586 16.6953 12.5862L11.8984 12.5862C11.3462 12.5862 10.8984 12.1385 10.8984 11.5862L10.8984 8.32251C10.8984 7.77023 11.3462 7.32251 11.8984 7.32251Z"
              stroke="#292B8C"
              strokeWidth="2"
            />
            <path
              d="M6.81348 12.2578L17.2187 12.2578C17.8319 12.2578 18.3834 12.631 18.6113 13.2002L20.4336 17.7549C20.8278 18.7402 20.1022 19.8125 19.041 19.8125L8.63574 19.8125C8.02241 19.8125 7.47097 19.4386 7.24316 18.8691L5.4209 14.3154C5.02674 13.3302 5.75231 12.2579 6.81348 12.2578Z"
              fill="#292B8C"
              stroke={isActive ? "white" : "#887FD4"}
            />
          </g>
        </svg>
      ),
    },
  ];

  const isActive = (href) => {
    return pathname === href;
  };

  const getNavigationStyle = (href) => {
    return `transition cursor-pointer ${
      isActive(href)
        ? "text-[#6D6FDF]"
        : "text-[#190E79] dark:text-white hover:text-[#6D6FDF]"
    }`;
  };

  const getMobileNavigationStyle = (href) => {
    return `flex flex-col items-center gap-1 transition cursor-pointer ${
      isActive(href)
        ? "text-[#190E79] dark:text-white"
        : "text-[#887FD4] hover:text-[#190E79] dark:text-white"
    }`;
  };

  const cycleTheme = () => {
    const themes = ["system", "light", "dark"];
    const currentIndex = themes.indexOf(theme);
    const nextIndex = (currentIndex + 1) % themes.length;
    const nextTheme = themes[nextIndex];
    console.log("Changing theme from", theme, "to", nextTheme);
    setTheme(nextTheme);
  };

  const getThemeIcon = () => {
    switch (theme) {
      case "light":
        return "☀️";
      case "dark":
        return "🌙";
      case "system":
      default:
        return "💻";
    }
  };

  const shortKey = publicKey
    ? publicKey.toString().slice(0, 4) + "..." + publicKey.toString().slice(-4)
    : null;

  const handleWalletButtonClick = async () => {
    if (publicKey) {
      await disconnect();
    } else {
      setShowWalletPopup(true);
    }
  };

  return (
    <>
      {/* Top Section - Mobile Header */}
      <div className="dark:bg-dark dark:text-light fixed top-0 z-50 w-full border-b border-gray-200 bg-white py-2 text-black md:py-4 lg:hidden dark:border-transparent">
        <div className="flex items-center justify-between px-4 lg:justify-center lg:gap-40">
          <Link href="/" className="flex items-center gap-2">
            <svg
              width="166"
              height="33"
              viewBox="0 0 166 33"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              className="h-6 w-auto lg:h-8"
            >
              <path
                d="M146.674 17.3437C146.674 18.8251 146.983 20.1521 147.6 21.3249C148.238 22.477 149.112 23.3823 150.223 24.0407C151.334 24.6991 152.6 25.0283 154.019 25.0283C155.459 25.0283 156.725 24.6991 157.815 24.0407C158.926 23.3823 159.79 22.477 160.408 21.3249C161.045 20.1521 161.364 18.8251 161.364 17.3437C161.364 15.8623 161.056 14.5456 160.438 13.3934C159.821 12.2207 158.957 11.3051 157.846 10.6467C156.756 9.98832 155.48 9.65913 154.019 9.65913C152.6 9.65913 151.334 9.98832 150.223 10.6467C149.112 11.3051 148.238 12.2207 147.6 13.3934C146.983 14.5456 146.674 15.8623 146.674 17.3437ZM142.816 17.3437C142.816 15.7183 143.094 14.2267 143.65 12.8687C144.205 11.5108 144.987 10.3381 145.995 9.35051C147.024 8.34236 148.217 7.56053 149.575 7.00502C150.954 6.44951 152.435 6.17175 154.019 6.17175C155.645 6.17175 157.136 6.44951 158.494 7.00502C159.852 7.56053 161.035 8.34236 162.043 9.35051C163.072 10.3381 163.864 11.5108 164.42 12.8687C164.975 14.2267 165.253 15.7183 165.253 17.3437C165.253 18.9485 164.975 20.4402 164.42 21.8187C163.864 23.1971 163.082 24.3905 162.074 25.3986C161.066 26.4068 159.873 27.1989 158.494 27.775C157.136 28.3305 155.645 28.6082 154.019 28.6082C152.414 28.6082 150.923 28.3305 149.544 27.775C148.166 27.1989 146.972 26.4068 145.964 25.3986C144.977 24.3905 144.205 23.1971 143.65 21.8187C143.094 20.4402 142.816 18.9485 142.816 17.3437Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M136.391 6.54238H139.971V29.2257L124.201 13.6406V28.1456H120.621V5.46222L136.391 21.0474V6.54238Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M102.614 22.5896L103.293 19.5034H113.323L114.033 22.5896H102.614ZM108.262 12.6521L104.867 20.5836L104.805 21.386L101.812 28.1447H97.707L108.262 5.33789L118.816 28.1447H114.712L111.78 21.5712L111.687 20.6762L108.262 12.6521Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M81.6211 6.54248H85.3554V28.1457H81.6211V6.54248ZM93.3794 6.54248H97.7618L88.6576 16.6651L98.2247 28.1457H93.7498L84.2443 16.7577L93.3794 6.54248Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M60.2093 17.3437C60.2093 18.8251 60.5179 20.1521 61.1351 21.3249C61.7729 22.477 62.6474 23.3823 63.7584 24.0407C64.8694 24.6991 66.1347 25.0283 67.5544 25.0283C68.9946 25.0283 70.2599 24.6991 71.3504 24.0407C72.4614 23.3823 73.3255 22.477 73.9428 21.3249C74.5806 20.1521 74.8995 18.8251 74.8995 17.3437C74.8995 15.8623 74.5908 14.5456 73.9736 13.3934C73.3564 12.2207 72.4922 11.3051 71.3812 10.6467C70.2908 9.98832 69.0152 9.65913 67.5544 9.65913C66.1347 9.65913 64.8694 9.98832 63.7584 10.6467C62.6474 11.3051 61.7729 12.2207 61.1351 13.3934C60.5179 14.5456 60.2093 15.8623 60.2093 17.3437ZM56.3516 17.3437C56.3516 15.7183 56.6293 14.2267 57.1848 12.8687C57.7403 11.5108 58.5222 10.3381 59.5303 9.35051C60.559 8.34236 61.7524 7.56053 63.1103 7.00502C64.4888 6.44951 65.9701 6.17175 67.5544 6.17175C69.1798 6.17175 70.6714 6.44951 72.0293 7.00502C73.3872 7.56053 74.5703 8.34236 75.5784 9.35051C76.6071 10.3381 77.3993 11.5108 77.9548 12.8687C78.5103 14.2267 78.788 15.7183 78.788 17.3437C78.788 18.9485 78.5103 20.4402 77.9548 21.8187C77.3993 23.1971 76.6174 24.3905 75.6093 25.3986C74.6011 26.4068 73.4078 27.1989 72.0293 27.775C70.6714 28.3305 69.1798 28.6082 67.5544 28.6082C65.9496 28.6082 64.4579 28.3305 63.0794 27.775C61.7009 27.1989 60.5076 26.4068 59.4995 25.3986C58.5119 24.3905 57.7403 23.1971 57.1848 21.8187C56.6293 20.4402 56.3516 18.9485 56.3516 17.3437Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M42.125 9.90641V6.54248H57.1855V9.90641H51.4761V28.1457H47.8036V9.90641H42.125Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M23.8438 16.9609C23.8879 16.9609 23.9307 16.977 23.9639 17.0059L27.334 19.9443C27.4592 20.054 27.3811 20.2587 27.2139 20.2588H21.2119V21.9512C21.2119 22.0981 21.0957 22.2176 20.9521 22.2178H11.7842C11.6407 22.2175 11.5245 22.0981 11.5244 21.9512V20.2588H5.52246C5.35536 20.2587 5.27727 20.0539 5.40234 19.9443L8.77246 17.0059C8.80561 16.977 8.84843 16.9609 8.89258 16.9609H23.8438Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M15.1777 8.82031C15.2829 8.82031 15.3682 8.9342 15.3682 9.07422V11.7217H17.3682V9.07422C17.3682 8.93432 17.4535 8.8205 17.5586 8.82031H21.1777C21.2829 8.82031 21.3682 8.9342 21.3682 9.07422V11.7217H23.8691C23.9133 11.7217 23.9561 11.7377 23.9893 11.7666L27.3594 14.7051C27.4846 14.8147 27.4065 15.0195 27.2393 15.0195H5.54785C5.38075 15.0194 5.30266 14.8147 5.42773 14.7051L8.79785 11.7666C8.831 11.7377 8.87382 11.7217 8.91797 11.7217H11.3682V9.07422C11.3682 8.93432 11.4535 8.8205 11.5586 8.82031H15.1777Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M16.3818 0C25.4289 0.000177298 32.7625 7.33382 32.7627 16.3809C32.7627 25.428 25.429 32.7625 16.3818 32.7627C7.33454 32.7627 0 25.4282 0 16.3809C0.000177297 7.33371 7.33465 0 16.3818 0ZM16.3818 3.69922C9.3781 3.69922 3.70037 9.37717 3.7002 16.3809C3.7002 23.3847 9.37799 29.0625 16.3818 29.0625C23.3855 29.0623 29.0635 23.3846 29.0635 16.3809C29.0633 9.37728 23.3854 3.6994 16.3818 3.69922Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
            </svg>
          </Link>
          <div className="flex items-center gap-3">
            <button
              onClick={cycleTheme}
              className="flex cursor-pointer items-center gap-1 rounded-lg border border-gray-400 px-2 py-1 text-xs transition hover:opacity-70 dark:border-gray-500"
              title={`Current: ${theme} mode. Click to change`}
            >
              <span className="text-base">{getThemeIcon()}</span>
              <span className="capitalize">{theme}</span>
            </button>
            <button
              onClick={handleWalletButtonClick}
              className="cursor-pointer text-sm transition hover:opacity-70"
            >
              {publicKey ? shortKey : "CONNECT"}
            </button>
          </div>
        </div>
      </div>

      {/* Navigation Section - Desktop */}
      <div className="dark:bg-dark dark:text-light hidden grid-cols-3 items-center border-b border-gray-200 bg-white py-6 text-black lg:grid dark:border-transparent">
        <div className="flex items-center justify-center gap-2">
          <Link href="/" className="flex items-center gap-2">
            <svg
              width="166"
              height="33"
              viewBox="0 0 166 33"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              className="h-6 w-auto lg:h-8"
            >
              <path
                d="M146.674 17.3437C146.674 18.8251 146.983 20.1521 147.6 21.3249C148.238 22.477 149.112 23.3823 150.223 24.0407C151.334 24.6991 152.6 25.0283 154.019 25.0283C155.459 25.0283 156.725 24.6991 157.815 24.0407C158.926 23.3823 159.79 22.477 160.408 21.3249C161.045 20.1521 161.364 18.8251 161.364 17.3437C161.364 15.8623 161.056 14.5456 160.438 13.3934C159.821 12.2207 158.957 11.3051 157.846 10.6467C156.756 9.98832 155.48 9.65913 154.019 9.65913C152.6 9.65913 151.334 9.98832 150.223 10.6467C149.112 11.3051 148.238 12.2207 147.6 13.3934C146.983 14.5456 146.674 15.8623 146.674 17.3437ZM142.816 17.3437C142.816 15.7183 143.094 14.2267 143.65 12.8687C144.205 11.5108 144.987 10.3381 145.995 9.35051C147.024 8.34236 148.217 7.56053 149.575 7.00502C150.954 6.44951 152.435 6.17175 154.019 6.17175C155.645 6.17175 157.136 6.44951 158.494 7.00502C159.852 7.56053 161.035 8.34236 162.043 9.35051C163.072 10.3381 163.864 11.5108 164.42 12.8687C164.975 14.2267 165.253 15.7183 165.253 17.3437C165.253 18.9485 164.975 20.4402 164.42 21.8187C163.864 23.1971 163.082 24.3905 162.074 25.3986C161.066 26.4068 159.873 27.1989 158.494 27.775C157.136 28.3305 155.645 28.6082 154.019 28.6082C152.414 28.6082 150.923 28.3305 149.544 27.775C148.166 27.1989 146.972 26.4068 145.964 25.3986C144.977 24.3905 144.205 23.1971 143.65 21.8187C143.094 20.4402 142.816 18.9485 142.816 17.3437Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M136.391 6.54238H139.971V29.2257L124.201 13.6406V28.1456H120.621V5.46222L136.391 21.0474V6.54238Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M102.614 22.5896L103.293 19.5034H113.323L114.033 22.5896H102.614ZM108.262 12.6521L104.867 20.5836L104.805 21.386L101.812 28.1447H97.707L108.262 5.33789L118.816 28.1447H114.712L111.78 21.5712L111.687 20.6762L108.262 12.6521Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M81.6211 6.54248H85.3554V28.1457H81.6211V6.54248ZM93.3794 6.54248H97.7618L88.6576 16.6651L98.2247 28.1457H93.7498L84.2443 16.7577L93.3794 6.54248Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M60.2093 17.3437C60.2093 18.8251 60.5179 20.1521 61.1351 21.3249C61.7729 22.477 62.6474 23.3823 63.7584 24.0407C64.8694 24.6991 66.1347 25.0283 67.5544 25.0283C68.9946 25.0283 70.2599 24.6991 71.3504 24.0407C72.4614 23.3823 73.3255 22.477 73.9428 21.3249C74.5806 20.1521 74.8995 18.8251 74.8995 17.3437C74.8995 15.8623 74.5908 14.5456 73.9736 13.3934C73.3564 12.2207 72.4922 11.3051 71.3812 10.6467C70.2908 9.98832 69.0152 9.65913 67.5544 9.65913C66.1347 9.65913 64.8694 9.98832 63.7584 10.6467C62.6474 11.3051 61.7729 12.2207 61.1351 13.3934C60.5179 14.5456 60.2093 15.8623 60.2093 17.3437ZM56.3516 17.3437C56.3516 15.7183 56.6293 14.2267 57.1848 12.8687C57.7403 11.5108 58.5222 10.3381 59.5303 9.35051C60.559 8.34236 61.7524 7.56053 63.1103 7.00502C64.4888 6.44951 65.9701 6.17175 67.5544 6.17175C69.1798 6.17175 70.6714 6.44951 72.0293 7.00502C73.3872 7.56053 74.5703 8.34236 75.5784 9.35051C76.6071 10.3381 77.3993 11.5108 77.9548 12.8687C78.5103 14.2267 78.788 15.7183 78.788 17.3437C78.788 18.9485 78.5103 20.4402 77.9548 21.8187C77.3993 23.1971 76.6174 24.3905 75.6093 25.3986C74.6011 26.4068 73.4078 27.1989 72.0293 27.775C70.6714 28.3305 69.1798 28.6082 67.5544 28.6082C65.9496 28.6082 64.4579 28.3305 63.0794 27.775C61.7009 27.1989 60.5076 26.4068 59.4995 25.3986C58.5119 24.3905 57.7403 23.1971 57.1848 21.8187C56.6293 20.4402 56.3516 18.9485 56.3516 17.3437Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M42.125 9.90641V6.54248H57.1855V9.90641H51.4761V28.1457H47.8036V9.90641H42.125Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M23.8438 16.9609C23.8879 16.9609 23.9307 16.977 23.9639 17.0059L27.334 19.9443C27.4592 20.054 27.3811 20.2587 27.2139 20.2588H21.2119V21.9512C21.2119 22.0981 21.0957 22.2176 20.9521 22.2178H11.7842C11.6407 22.2175 11.5245 22.0981 11.5244 21.9512V20.2588H5.52246C5.35536 20.2587 5.27727 20.0539 5.40234 19.9443L8.77246 17.0059C8.80561 16.977 8.84843 16.9609 8.89258 16.9609H23.8438Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                d="M15.1777 8.82031C15.2829 8.82031 15.3682 8.9342 15.3682 9.07422V11.7217H17.3682V9.07422C17.3682 8.93432 17.4535 8.8205 17.5586 8.82031H21.1777C21.2829 8.82031 21.3682 8.9342 21.3682 9.07422V11.7217H23.8691C23.9133 11.7217 23.9561 11.7377 23.9893 11.7666L27.3594 14.7051C27.4846 14.8147 27.4065 15.0195 27.2393 15.0195H5.54785C5.38075 15.0194 5.30266 14.8147 5.42773 14.7051L8.79785 11.7666C8.831 11.7377 8.87382 11.7217 8.91797 11.7217H11.3682V9.07422C11.3682 8.93432 11.4535 8.8205 11.5586 8.82031H15.1777Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M16.3818 0C25.4289 0.000177298 32.7625 7.33382 32.7627 16.3809C32.7627 25.428 25.429 32.7625 16.3818 32.7627C7.33454 32.7627 0 25.4282 0 16.3809C0.000177297 7.33371 7.33465 0 16.3818 0ZM16.3818 3.69922C9.3781 3.69922 3.70037 9.37717 3.7002 16.3809C3.7002 23.3847 9.37799 29.0625 16.3818 29.0625C23.3855 29.0623 29.0635 23.3846 29.0635 16.3809C29.0633 9.37728 23.3854 3.6994 16.3818 3.69922Z"
                fill={resolvedTheme === "dark" ? "#EEEDED" : "#0E1379"}
              />
            </svg>
          </Link>
        </div>

        <div className="text-md font-khand flex justify-center gap-4 font-medium lg:gap-8 lg:text-2xl">
          {navigationItems
            .filter((item) => item.name !== "HOME")
            .map((item) => (
              <Link
                key={item.name}
                href={item.href}
                className={getNavigationStyle(item.href)}
              >
                {item.name}
              </Link>
            ))}
        </div>

        <div className="flex items-center justify-center gap-4">
          <button
            onClick={handleWalletButtonClick}
            className="cursor-pointer transition hover:opacity-70"
          >
            {publicKey ? shortKey : "CONNECT WALLET"}
          </button>
          <button
            onClick={cycleTheme}
            className="dark:border-secondary ml-12 flex cursor-pointer items-center gap-2 rounded-lg border border-[#CDCDE9] px-3 py-2 text-sm transition hover:opacity-70"
            title={`Current: ${theme} mode. Click to change`}
          >
            <span className="text-xl">{getThemeIcon()}</span>
            <span className="capitalize">{theme}</span>
          </button>
        </div>
      </div>

      {/* Bottom Navigation for Mobile */}
      <div
        className="text-light fixed bottom-0 z-50 w-full py-1 lg:hidden"
        style={{
          background:
            resolvedTheme === "dark"
              ? "linear-gradient(90deg, #292B8C 0%, #2A2B8D 99.99%, rgba(78, 52, 222, 0) 100%)"
              : "linear-gradient(90deg, #d5d2ec 0%, #e0dff5 99.99%, rgba(213, 210, 236, 0) 100%)",
        }}
      >
        <div className="flex items-center justify-around text-sm">
          {navigationItems.map((item) => (
            <Link
              key={item.name}
              href={item.href}
              className={getMobileNavigationStyle(item.href)}
            >
              {item.icon(isActive(item.href))}
              <span className="text-xs">{item.name}</span>
            </Link>
          ))}
        </div>
      </div>

      {/* Wallet Selection Popup */}
      <WalletSelectionPopup
        isOpen={showWalletPopup}
        onClose={() => setShowWalletPopup(false)}
      />
    </>
  );
}

export default Navbar;
