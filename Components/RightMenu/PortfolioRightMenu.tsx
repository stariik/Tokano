"use client";
import React, { useState, useEffect } from "react";
import TokanoBalance from "./ui/TokanoBalance";
import Details from "./ui/Details";
import GlobalData from "./ui/GlobalData";

const TokanoHeader = () => (
  <svg
    width="179"
    height="35"
    viewBox="0 0 179 35"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M158.273 18.0971C158.273 19.75 158.618 21.2308 159.306 22.5393C160.018 23.8249 160.994 24.835 162.233 25.5697C163.473 26.3043 164.885 26.6716 166.469 26.6716C168.076 26.6716 169.488 26.3043 170.705 25.5697C171.944 24.835 172.908 23.8249 173.597 22.5393C174.309 21.2308 174.665 19.75 174.665 18.0971C174.665 16.4442 174.32 14.9749 173.632 13.6893C172.943 12.3808 171.979 11.3592 170.739 10.6245C169.522 9.88991 168.099 9.52259 166.469 9.52259C164.885 9.52259 163.473 9.88991 162.233 10.6245C160.994 11.3592 160.018 12.3808 159.306 13.6893C158.618 14.9749 158.273 16.4442 158.273 18.0971ZM153.969 18.0971C153.969 16.2835 154.279 14.6191 154.899 13.1039C155.518 11.5887 156.391 10.2802 157.516 9.17823C158.664 8.05333 159.995 7.18096 161.51 6.56111C163.048 5.94127 164.701 5.63135 166.469 5.63135C168.283 5.63135 169.947 5.94127 171.462 6.56111C172.977 7.18096 174.297 8.05333 175.422 9.17823C176.57 10.2802 177.454 11.5887 178.074 13.1039C178.694 14.6191 179.004 16.2835 179.004 18.0971C179.004 19.8878 178.694 21.5522 178.074 23.0903C177.454 24.6284 176.582 25.9599 175.457 27.0848C174.332 28.2097 173 29.0936 171.462 29.7364C169.947 30.3562 168.283 30.6662 166.469 30.6662C164.678 30.6662 163.014 30.3562 161.476 29.7364C159.938 29.0936 158.606 28.2097 157.481 27.0848C156.379 25.9599 155.518 24.6284 154.899 23.0903C154.279 21.5522 153.969 19.8878 153.969 18.0971Z"
      fill="#464B7E"
    />
    <path
      d="M146.8 6.04436H150.794V31.3547L133.198 13.9646V30.1494H129.203V4.83911L146.8 22.2292V6.04436Z"
      fill="#464B7E"
    />
    <path
      d="M109.112 23.9508L109.87 20.5072H121.061L121.853 23.9508H109.112ZM115.414 12.8625L111.626 21.7124L111.557 22.6078L108.217 30.1492H103.637L115.414 4.70117L127.191 30.1492H122.611L119.339 22.8144L119.236 21.8158L115.414 12.8625Z"
      fill="#464B7E"
    />
    <path
      d="M85.6875 6.0437H89.8542V30.1488H85.6875V6.0437ZM98.8075 6.0437H103.697L93.5389 17.3386L104.214 30.1488H99.2208L88.6145 17.4419L98.8075 6.0437Z"
      fill="#464B7E"
    />
    <path
      d="M61.8006 18.0971C61.8006 19.75 62.1449 21.2308 62.8336 22.5393C63.5453 23.8249 64.521 24.835 65.7607 25.5697C67.0004 26.3043 68.4122 26.6716 69.9963 26.6716C71.6033 26.6716 73.0152 26.3043 74.2319 25.5697C75.4716 24.835 76.4358 23.8249 77.1245 22.5393C77.8362 21.2308 78.192 19.75 78.192 18.0971C78.192 16.4442 77.8476 14.9749 77.1589 13.6893C76.4702 12.3808 75.506 11.3592 74.2663 10.6245C73.0496 9.88991 71.6262 9.52259 69.9963 9.52259C68.4122 9.52259 67.0004 9.88991 65.7607 10.6245C64.521 11.3592 63.5453 12.3808 62.8336 13.6893C62.1449 14.9749 61.8006 16.4442 61.8006 18.0971ZM57.4961 18.0971C57.4961 16.2835 57.806 14.6191 58.4259 13.1039C59.0457 11.5887 59.9181 10.2802 61.043 9.17823C62.1908 8.05333 63.5224 7.18096 65.0375 6.56111C66.5757 5.94127 68.2286 5.63135 69.9963 5.63135C71.8099 5.63135 73.4743 5.94127 74.9895 6.56111C76.5046 7.18096 77.8247 8.05333 78.9496 9.17823C80.0974 10.2802 80.9813 11.5887 81.6011 13.1039C82.221 14.6191 82.5309 16.2835 82.5309 18.0971C82.5309 19.8878 82.221 21.5522 81.6011 23.0903C80.9813 24.6284 80.1089 25.9599 78.984 27.0848C77.8591 28.2097 76.5276 29.0936 74.9895 29.7364C73.4743 30.3562 71.8099 30.6662 69.9963 30.6662C68.2056 30.6662 66.5412 30.3562 65.0031 29.7364C63.465 29.0936 62.1334 28.2097 61.0085 27.0848C59.9066 25.9599 59.0457 24.6284 58.4259 23.0903C57.806 21.5522 57.4961 19.8878 57.4961 18.0971Z"
      fill="#464B7E"
    />
    <path
      d="M41.6172 9.7972V6.0437H58.4218V9.7972H52.0512V30.1488H47.9534V9.7972H41.6172Z"
      fill="#464B7E"
    />
    <circle
      cx="15.191"
      cy="15.191"
      r="15.191"
      transform="matrix(-1 0 0 1 32.3828 2)"
      stroke="#464B7E"
      strokeWidth="4"
      strokeLinecap="round"
    />
    <path
      d="M25.2405 17.7766C25.2058 17.7464 25.1612 17.7297 25.1151 17.7297H9.48529C9.43913 17.7297 9.39456 17.7464 9.35991 17.7766L5.83705 20.8481C5.70568 20.9627 5.78744 21.1773 5.96242 21.1773H28.638C28.8129 21.1773 28.8947 20.9627 28.7633 20.8481L25.2405 17.7766Z"
      fill="#464B7E"
    />
    <path
      d="M25.2678 12.2974C25.2332 12.2672 25.1886 12.2505 25.1424 12.2505H9.51263C9.46648 12.2505 9.42191 12.2672 9.38725 12.2974L5.86439 15.3689C5.73302 15.4834 5.81478 15.6981 5.98976 15.6981H28.6653C28.8403 15.6981 28.922 15.4834 28.7907 15.3689L25.2678 12.2974Z"
      fill="#464B7E"
    />
    <path
      d="M22.418 9.44277C22.418 9.30664 22.3351 9.19629 22.2328 9.19629H18.7142C18.6119 9.19629 18.529 9.30664 18.529 9.44277V12.8388C18.529 12.9749 18.6119 13.0852 18.7142 13.0852H22.2328C22.3351 13.0852 22.418 12.9749 22.418 12.8388V9.44277Z"
      fill="#464B7E"
    />
    <path
      d="M16.1953 9.6598C16.1953 9.51006 16.1124 9.38867 16.0101 9.38867H12.4915C12.3893 9.38867 12.3064 9.51006 12.3064 9.6598V13.3954C12.3064 13.5451 12.3893 13.6665 12.4915 13.6665H16.0101C16.1124 13.6665 16.1953 13.5451 16.1953 13.3954V9.6598Z"
      fill="#464B7E"
    />
    <path
      d="M22.3633 19.9479C22.3633 19.7941 22.2415 19.6694 22.0913 19.6694H12.5079C12.3577 19.6694 12.2359 19.7941 12.2359 19.9479V22.9463C12.2359 23.1001 12.3577 23.2248 12.5079 23.2248H22.0913C22.2415 23.2248 22.3633 23.1001 22.3633 22.9463V19.9479Z"
      fill="#464B7E"
    />
  </svg>
);

function PortfolioRightMenu() {
  const [show, setShow] = useState(false);

  // Prevent body scroll when menu is open on mobile
  useEffect(() => {
    if (show) {
      document.body.style.overflow = "hidden";
    } else {
      document.body.style.overflow = "unset";
    }
    return () => {
      document.body.style.overflow = "unset";
    };
  }, [show]);

  return (
    <div className="font-khand font-normal">
      <style jsx>{`
        .custom-scrollbar::-webkit-scrollbar {
          width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
          background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background: #8b5cf6;
          border-radius: 2px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background: #7c3aed;
        }
        .custom-scrollbar {
          scrollbar-width: thin;
          scrollbar-color: #8b5cf6 transparent;
        }
      `}</style>

      {/* Toggle button - mobile only */}
      <button
        onClick={() => setShow(true)}
        className={`border-secondary fixed right-0 bottom-22 z-70 flex flex-col items-center justify-center rounded-l-lg bg-white px-1 pl-1 text-sm font-bold text-[#190E79] shadow-2xl transition-all duration-300 ease-in-out [writing-mode:vertical-rl] hover:shadow-xl md:hidden dark:text-white ${
          show ? "pointer-events-none opacity-0" : "opacity-100"
        }`}
        id="right-menu-button"
        style={{
          boxShadow: "0 8px 25px rgba(0, 0, 0, 0.5)",
        }}
      >
        <svg
          width="32"
          height="28"
          viewBox="0 0 26 22"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          className="mx-2 mr-1"
        >
          <circle
            cx="10.4288"
            cy="10.4288"
            r="10.4288"
            transform="matrix(-1 0 0 1 25.5234 0.422119)"
            fill="#292B8C"
          />
          <path
            d="M20.5332 11.22C20.5648 11.22 20.5954 11.2315 20.6191 11.2522L23.0371 13.3606C23.1273 13.4392 23.0713 13.5862 22.9512 13.5862H18.6436V14.802C18.6435 14.9074 18.56 14.9933 18.457 14.9934H11.8779C11.7749 14.9934 11.6915 14.9075 11.6914 14.802V13.5862H7.38477C7.26464 13.5862 7.20864 13.4392 7.29883 13.3606L9.7168 11.2522C9.74052 11.2315 9.77114 11.22 9.80273 11.22H20.5332ZM18.5557 5.36157C18.6258 5.36157 18.6825 5.43722 18.6826 5.53052V7.45923H20.5479C20.5795 7.45923 20.61 7.47074 20.6338 7.49146L23.0527 9.59985C23.1427 9.67847 23.0868 9.82532 22.9668 9.82544H7.39941C7.27951 9.82525 7.22357 9.67847 7.31348 9.59985L9.73242 7.49146C9.75621 7.47072 9.78667 7.45923 9.81836 7.45923H11.7383V5.67993C11.7385 5.57751 11.7953 5.49464 11.8652 5.49438H14.2812C14.3513 5.4945 14.408 5.57743 14.4082 5.67993V7.45923H16.0127V5.53052C16.0128 5.43722 16.0705 5.36157 16.1406 5.36157H18.5557Z"
            fill="white"
          />
          <path
            d="M2.48613 0L2.48613 4.83081L0.53932 10.6846L2.48613 16.5953L2.48613 21.4261L0 13.3558L0 8.12713L2.48613 0Z"
            fill="#292B8C"
          />
        </svg>
      </button>

      {/* Overlay - mobile only */}
      {show && (
        <div
          className="menu-overlay-active fixed z-40 bg-black/60 md:hidden"
          style={{ top: "3.5rem", bottom: 0, left: 0, right: 0 }}
          onClick={() => setShow(false)}
        />
      )}

      {/* Right-side menu - Always visible on desktop for portfolio pages */}
      <div
        className={`custom-scrollbar dark:border-secondary shadow-[ -60px_0_120px_40px_rgba(10,0,40,0.85) ] fixed right-0 z-40 w-[90vw] max-w-sm overflow-y-auto rounded-tl-[2.5rem] border-l-2 border-[#CDCDE9] bg-white pb-6 transition-transform duration-300 ease-in-out md:overflow-visible lg:max-h-[83rem] lg:min-h-[83rem] xl:max-h-full dark:bg-[#12002a] ${show ? "translate-x-0" : "translate-x-full"} md:static md:top-2 md:z-0 md:h-auto md:w-auto md:max-w-none md:translate-x-0 md:border-2 md:pb-0 md:shadow-none 2xl:max-w-[620px]`}
        style={{ top: "3.5rem", bottom: 0, height: "auto" }}
      >
        <div
          className={`dark:border-secondary flex items-center justify-between rounded-tr-4xl border-b-2 border-[#CDCDE9] px-6 py-3 text-4xl`}
        >
          <TokanoHeader />
          <button
            onClick={() => setShow(false)}
            className="text-3xl text-[#190E79] transition-colors hover:text-purple-400 md:hidden dark:text-white"
          >
            âœ•
          </button>
        </div>
        <GlobalData />
        <div className="dark:border-secondary w-full border-y-2 border-[#CDCDE9] py-2 pl-4">
          <TokanoHeader />
        </div>
        <div className="px-2 xl:px-4 2xl:px-6">
          <TokanoBalance />
        </div>
        <div className="px-2 xl:px-4 2xl:px-6">
          <Details />
        </div>
        <div className="dark:border-secondary border-t-2 border-[#CDCDE9] py-2 pl-8 text-2xl lg:text-xl xl:text-2xl">
          <svg
            width="126"
            height="24"
            viewBox="0 0 126 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g opacity="0.43">
              <path
                d="M111.212 12.3532C111.212 13.5189 111.454 14.5633 111.94 15.4861C112.442 16.3928 113.13 17.1052 114.005 17.6233C114.879 18.1415 115.875 18.4005 116.992 18.4005C118.125 18.4005 119.121 18.1415 119.979 17.6233C120.853 17.1052 121.533 16.3928 122.019 15.4861C122.521 14.5633 122.772 13.5189 122.772 12.3532C122.772 11.1874 122.529 10.1512 122.043 9.24454C121.558 8.32166 120.878 7.60116 120.003 7.08305C119.145 6.56494 118.141 6.30588 116.992 6.30588C115.875 6.30588 114.879 6.56494 114.005 7.08305C113.13 7.60116 112.442 8.32166 111.94 9.24454C111.454 10.1512 111.212 11.1874 111.212 12.3532ZM108.176 12.3532C108.176 11.0741 108.394 9.90027 108.832 8.83167C109.269 7.76307 109.884 6.84019 110.677 6.06302C111.487 5.26967 112.426 4.65441 113.495 4.21725C114.579 3.7801 115.745 3.56152 116.992 3.56152C118.271 3.56152 119.445 3.7801 120.513 4.21725C121.582 4.65441 122.513 5.26967 123.306 6.06302C124.116 6.84019 124.739 7.76307 125.176 8.83167C125.613 9.90027 125.832 11.0741 125.832 12.3532C125.832 13.6161 125.613 14.7899 125.176 15.8747C124.739 16.9595 124.124 17.8986 123.33 18.6919C122.537 19.4853 121.598 20.1087 120.513 20.562C119.445 20.9992 118.271 21.2177 116.992 21.2177C115.729 21.2177 114.555 20.9992 113.47 20.562C112.385 20.1087 111.446 19.4853 110.653 18.6919C109.876 17.8986 109.269 16.9595 108.832 15.8747C108.394 14.7899 108.176 13.6161 108.176 12.3532Z"
                fill="#949DFF"
              />
              <path
                d="M103.117 3.85246H105.935V21.703L93.5243 9.43833V20.8529H90.707V3.00244L103.117 15.2671V3.85246Z"
                fill="#949DFF"
              />
              <path
                d="M76.5373 16.4814L77.0716 14.0527H84.9647L85.5233 16.4814H76.5373ZM80.9817 8.66115L78.3102 14.9027L78.2617 15.5342L75.9059 20.8529H72.6758L80.9817 2.90527L89.2877 20.8529H86.0576L83.7504 15.6799L83.6775 14.9756L80.9817 8.66115Z"
                fill="#949DFF"
              />
              <path
                d="M60.0195 3.85205H62.9582V20.8525H60.0195V3.85205ZM69.2726 3.85205H72.7213L65.5568 11.818L73.0856 20.8525H69.5641L62.0839 11.8908L69.2726 3.85205Z"
                fill="#949DFF"
              />
              <path
                d="M43.1725 12.3532C43.1725 13.5189 43.4154 14.5633 43.9011 15.4861C44.403 16.3928 45.0911 17.1052 45.9655 17.6233C46.8398 18.1415 47.8355 18.4005 48.9527 18.4005C50.086 18.4005 51.0818 18.1415 51.9399 17.6233C52.8142 17.1052 53.4942 16.3928 53.98 15.4861C54.4819 14.5633 54.7328 13.5189 54.7328 12.3532C54.7328 11.1874 54.49 10.1512 54.0042 9.24454C53.5185 8.32166 52.8385 7.60116 51.9642 7.08305C51.1061 6.56494 50.1022 6.30588 48.9527 6.30588C47.8355 6.30588 46.8398 6.56494 45.9655 7.08305C45.0911 7.60116 44.403 8.32166 43.9011 9.24454C43.4154 10.1512 43.1725 11.1874 43.1725 12.3532ZM40.1367 12.3532C40.1367 11.0741 40.3553 9.90027 40.7925 8.83167C41.2296 7.76307 41.8449 6.84019 42.6382 6.06302C43.4478 5.26967 44.3868 4.65441 45.4554 4.21725C46.5402 3.7801 47.706 3.56152 48.9527 3.56152C50.2318 3.56152 51.4056 3.7801 52.4742 4.21725C53.5428 4.65441 54.4738 5.26967 55.2671 6.06302C56.0767 6.84019 56.7 7.76307 57.1372 8.83167C57.5743 9.90027 57.7929 11.0741 57.7929 12.3532C57.7929 13.6161 57.5743 14.7899 57.1372 15.8747C56.7 16.9595 56.0848 17.8986 55.2914 18.6919C54.4981 19.4853 53.559 20.1087 52.4742 20.562C51.4056 20.9992 50.2318 21.2177 48.9527 21.2177C47.6898 21.2177 46.5159 20.9992 45.4312 20.562C44.3464 20.1087 43.4073 19.4853 42.6139 18.6919C41.8368 17.8986 41.2296 16.9595 40.7925 15.8747C40.3553 14.7899 40.1367 13.6161 40.1367 12.3532Z"
                fill="#949DFF"
              />
              <path
                d="M28.9375 6.49927V3.85205H40.7893V6.49927H36.2963V20.8525H33.4062V6.49927H28.9375Z"
                fill="#949DFF"
              />
            </g>
            <g opacity="0.43">
              <circle
                cx="10.7137"
                cy="10.7137"
                r="10.7137"
                transform="matrix(-1 0 0 1 22.4258 1)"
                stroke="#949DFF"
                strokeWidth="2"
                strokeLinecap="round"
              />
              <path
                d="M17.3877 12.1268C17.3633 12.1055 17.3318 12.0938 17.2993 12.0938H6.27612C6.24357 12.0938 6.21213 12.1055 6.1877 12.1268L3.70314 14.293C3.61049 14.3738 3.66815 14.5252 3.79156 14.5252H19.7838C19.9073 14.5252 19.9649 14.3738 19.8723 14.293L17.3877 12.1268Z"
                fill="#949DFF"
              />
              <path
                d="M17.4072 8.26255C17.3828 8.24124 17.3514 8.22949 17.3188 8.22949H6.29565C6.2631 8.22949 6.23166 8.24124 6.20723 8.26255L3.72267 10.4288C3.63002 10.5096 3.68768 10.661 3.81109 10.661H19.8034C19.9268 10.661 19.9845 10.5096 19.8918 10.4288L17.4072 8.26255Z"
                fill="#949DFF"
              />
              <path
                d="M15.3984 6.24903C15.3984 6.15302 15.34 6.0752 15.2678 6.0752H12.7863C12.7142 6.0752 12.6557 6.15302 12.6557 6.24903V8.64411C12.6557 8.74012 12.7142 8.81795 12.7863 8.81795H15.2678C15.34 8.81795 15.3984 8.74012 15.3984 8.64411V6.24903Z"
                fill="#949DFF"
              />
              <path
                d="M11.0117 6.40216C11.0117 6.29655 10.9532 6.21094 10.8811 6.21094H8.39958C8.32744 6.21094 8.26897 6.29655 8.26897 6.40216V9.03674C8.26897 9.14235 8.32744 9.22796 8.39958 9.22796H10.8811C10.9532 9.22796 11.0117 9.14235 11.0117 9.03674V6.40216Z"
                fill="#949DFF"
              />
              <path
                d="M15.3594 13.6583C15.3594 13.5498 15.2735 13.4619 15.1675 13.4619H8.40874C8.30279 13.4619 8.2169 13.5498 8.2169 13.6583V15.773C8.2169 15.8815 8.30279 15.9694 8.40874 15.9694H15.1675C15.2735 15.9694 15.3594 15.8815 15.3594 15.773V13.6583Z"
                fill="#949DFF"
              />
            </g>
          </svg>
        </div>
      </div>
    </div>
  );
}

export default PortfolioRightMenu;
